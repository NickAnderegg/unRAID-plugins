Menu="NetworkServices"
Type="xmenu"
Title="Wake On Lan"
Icon="wakeonlan.png"
---
<?php
$excludeip = $var['IPADDR'];
$ifname = exec("ifconfig | awk 'BEGIN { ifname = 0 } /$excludeip/ { ifname = 1 } /^($|[^\t])/ { if(ifname) print buffer; buffer = $1; ifname = 0 } END { if(ifname) print buffer }' |  sed s/\:/\/g");
?>

<script type="text/javascript" src="/plugins/wakeonlan/javascript/jquery.mask.js"></script>
<script type="text/javascript" src="/plugins/wakeonlan/javascript/jquery.wakeonlan.js"></script>
<link type="text/css" rel="stylesheet" href="/plugins/wakeonlan/styles/wakeonlan.css">

<div>
	<table class="tablesorter wakeonlan" id="tblData">			
		<thead>
			<tr>
				<th> Status </th>
				<th> Hostname </th>
				<th> IP Address </th>
				<th> MAC Address </th>
				<th class="powercfg"> User Name</th>
				<th class="powercfg"> Password </th>
				<th class="powercfg"> Operating System</th>
				<th> Action </th>
			</tr>
		</thead>
		<tbody>
		</tbody>
	</table>
	<div style="margin-left:18px">
		<button type="button" id="btnNew"/>new</button>
			<button type="button" id="btnDone" onclick="done();"/>Done</button>
 	</div>
</div>
<div>
	<div id="title">
		<span class="left"><img src="/plugins/dynamix/icons/networkservices.png"> Network Scan</span>
	</div>  
	<table class="tablesorter scan" id="tblScan">			
		<thead>
			<tr>
   			<th> Add </th>
   			<th> Hostname </th>
				<th> IP Address </th>
				<th> MAC Address </th>
   			<th></th>
			</tr>
		</thead>
		<tbody>
		</tbody>
	</table>
		<div style="margin-left:18px">
			<button type="button" id="btnScan"onclick="Scan('<?=$excludeip?>');"/>scan</button>
			<button type="button" id="btnClear" onclick="$('#tblScan tbody').empty();window.parent.scrollTo(0,0);"/>Clear</button>
			</div>
</div>

<div id="preload">
   <img src='/plugins/dynamix/images/loading.gif'>
</div>

<script type="text/javascript">
function Wake(){
	var ifName = "<?=$ifname?>";
	var par = $(this).parent()
	var tdStatus = par.children("td:nth-child(1)");
	var macAddress = par.children("td:nth-child(4)").html();
	tdStatus.html("<img src='/plugins/dynamix/images/loading.gif'>");
  	$.ajax({
     	type : "POST",
      url : "/plugins/wakeonlan/include/wake.php",
      data : {mac: macAddress, ifname: ifName},
      success: function() {
          setTimeout(ScanIP, 9999);
       },
       error : function() {
       }
   });
};
</script>